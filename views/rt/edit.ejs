<%- include('../layouts/header', { title: 'Edit RT - Zakat Fitrah App',
bodyClass: 'bg-gray-50 min-h-screen', currentPage: 'rt' }) %>

<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="mb-6">
    <div class="flex items-center mb-4">
      <a href="/rt" class="text-primary-600 hover:text-primary-800 mr-4">
        <i class="fas fa-arrow-left"></i>
      </a>
      <h1 class="text-3xl font-bold text-gray-900">
        <i class="fas fa-edit mr-2 text-primary-600"></i>Edit RT
      </h1>
    </div>
    <p class="text-gray-600">Edit data RT <%= rt.nomor_rt %></p>
  </div>

  <!-- Form -->
  <div class="bg-white shadow-sm rounded-lg overflow-hidden">
    <div class="px-6 py-4 border-b border-gray-200">
      <h2 class="text-lg font-semibold text-gray-900">Informasi RT</h2>
    </div>

    <form
      method="POST"
      action="/rt/<%= rt.id %>/edit"
      class="p-6 space-y-6"
      id="rt-form"
    >
      <!-- Nomor RT -->
      <div>
        <label
          for="nomor_rt"
          class="block text-sm font-medium text-gray-700 mb-2"
        >
          Nomor RT <span class="text-red-500">*</span>
        </label>
        <div class="relative">
          <div
            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
          >
            <i class="fas fa-home text-gray-400"></i>
          </div>
          <input
            type="text"
            id="nomor_rt"
            name="nomor_rt"
            required
            value="<%= rt.nomor_rt %>"
            placeholder="Contoh: RT 01, RT 02, dll"
            class="appearance-none block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500"
          />
        </div>
        <p class="mt-1 text-sm text-gray-500">
          Masukkan nomor RT, contoh: RT 01, RT 02, RT 11, dll.
        </p>
      </div>

      <!-- Ketua RT -->
      <div>
        <label
          for="ketua_rt"
          class="block text-sm font-medium text-gray-700 mb-2"
        >
          Nama Ketua RT <span class="text-red-500">*</span>
        </label>
        <div class="relative">
          <div
            class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
          >
            <i class="fas fa-user text-gray-400"></i>
          </div>
          <input
            type="text"
            id="ketua_rt"
            name="ketua_rt"
            required
            value="<%= rt.ketua_rt %>"
            placeholder="Nama lengkap ketua RT"
            class="appearance-none block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500"
          />
        </div>
        <p class="mt-1 text-sm text-gray-500">Masukkan nama lengkap ketua RT</p>
      </div>

      <!-- Keterangan -->
      <div>
        <label
          for="keterangan"
          class="block text-sm font-medium text-gray-700 mb-2"
        >
          Keterangan
        </label>
        <div class="relative">
          <div
            class="absolute top-3 left-0 pl-3 flex items-start pointer-events-none"
          >
            <i class="fas fa-sticky-note text-gray-400"></i>
          </div>
          <textarea
            id="keterangan"
            name="keterangan"
            rows="3"
            placeholder="Catatan tambahan atau keterangan RT (opsional)"
            class="appearance-none block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500"
          >
<%= rt.keterangan || '' %></textarea
          >
        </div>
        <p class="mt-1 text-sm text-gray-500">
          Keterangan tambahan tentang RT (opsional)
        </p>
      </div>

      <!-- Action Buttons -->
      <div
        class="flex items-center justify-between pt-6 border-t border-gray-200"
      >
        <a href="/rt" class="btn-secondary">
          <i class="fas fa-times mr-2"></i>Batal
        </a>
        <button type="submit" class="btn-primary">
          <i class="fas fa-save mr-2"></i>Simpan Perubahan
        </button>
      </div>
    </form>
  </div>

  <!-- Information -->
  <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mt-6">
    <div class="flex">
      <div class="flex-shrink-0">
        <i class="fas fa-exclamation-triangle text-yellow-400"></i>
      </div>
      <div class="ml-3">
        <h3 class="text-sm font-medium text-yellow-800">Informasi Penting</h3>
        <div class="mt-2 text-sm text-yellow-700">
          <ul class="list-disc space-y-1 ml-4">
            <li>
              Perubahan nomor RT akan mempengaruhi semua data muzakki di RT ini
            </li>
            <li>Pastikan nomor RT yang baru tidak bentrok dengan RT lain</li>
            <li>Data yang sudah disimpan tidak dapat dikembalikan</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById("rt-form").addEventListener("submit", function (e) {
    const nomorRt = document.getElementById("nomor_rt").value.trim();
    const ketuaRt = document.getElementById("ketua_rt").value.trim();

    if (!nomorRt || !ketuaRt) {
      e.preventDefault();
      alert("Nomor RT dan Nama Ketua RT harus diisi");
      return false;
    }

    return confirm("Apakah perubahan data RT sudah benar?");
  });

  // Format input nomor RT
  document.getElementById("nomor_rt").addEventListener("input", function (e) {
    let value = e.target.value.toUpperCase();

    // Auto format RT if user types just numbers
    if (/^\d+$/.test(value)) {
      const num = parseInt(value);
      if (num < 10) {
        value = `RT 0${num}`;
      } else {
        value = `RT ${num}`;
      }
      e.target.value = value;
    }
  });
</script>

<%- include('layouts/footer') %>
