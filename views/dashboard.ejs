<%- include('layouts/header', { title: 'Dashboard - Zakat Fitrah App',
bodyClass: 'bg-gray-50 min-h-screen', currentPage: 'dashboard' }) %>

<!-- Dashboard Container with Enhanced Design -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8">
  <!-- Enhanced Header Section -->
  <div
    class="relative dashboard-gradient-header rounded-2xl shadow-xl overflow-hidden"
  >
    <div class="absolute inset-0 bg-black opacity-10"></div>
    <div
      class="absolute top-0 right-0 transform translate-x-16 -translate-y-8 animate-float"
    >
      <div class="w-40 h-40 bg-white opacity-10 rounded-full"></div>
    </div>
    <div
      class="absolute bottom-0 left-0 transform -translate-x-8 translate-y-8 animate-float"
      style="animation-delay: 1.5s"
    >
      <div class="w-32 h-32 bg-white opacity-10 rounded-full"></div>
    </div>
    <div class="relative px-6 py-8 sm:px-8 sm:py-10">
      <div
        class="flex flex-col sm:flex-row items-start sm:items-center justify-between"
      >
        <div>
          <div class="flex items-center mb-2">
            <div class="bg-white/20 p-3 rounded-xl mr-4 backdrop-blur-sm">
              <i class="fas fa-tachometer-alt text-white text-xl"></i>
            </div>
            <h1 class="text-3xl sm:text-4xl font-bold text-white">Dashboard</h1>
          </div>
          <p class="text-blue-100 text-lg">
            Selamat datang kembali,
            <span class="font-semibold text-white"
              ><%= (user && user.name) ? user.name : 'User' %></span
            >
          </p>
          <p class="text-blue-200 text-sm mt-1">
            Kelola data zakat fitrah dengan mudah dan efisien
          </p>
        </div>
        <div class="mt-4 sm:mt-0">
          <div class="text-right">
            <div class="text-blue-200 text-sm">Hari ini</div>
            <div class="text-white font-semibold" id="current-date"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Stats Cards -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6">
    <!-- Total Muzakki Card -->
    <div
      class="group bg-white overflow-hidden shadow-lg rounded-2xl card-hover-effect border border-gray-100"
    >
      <div class="card-gradient-blue p-4">
        <div class="flex items-center justify-between">
          <div class="bg-white/20 p-3 rounded-xl backdrop-blur-sm">
            <i class="fas fa-users text-white text-lg"></i>
          </div>
          <div class="text-white/80 text-right">
            <div class="text-2xl sm:text-3xl font-bold text-white">
              <%= stats.totalMuzakki || 0 %>
            </div>
          </div>
        </div>
      </div>
      <div class="p-4">
        <h3 class="text-gray-700 font-semibold text-base">Total Muzakki</h3>
        <p class="text-gray-500 text-sm mt-1">Terdaftar dalam sistem</p>
        <div class="mt-3 flex items-center">
          <div
            class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-xs font-medium"
          >
            <i class="fas fa-arrow-up mr-1"></i>Aktif
          </div>
        </div>
      </div>
    </div>

    <!-- Total Zakat Card -->
    <div
      class="group bg-white overflow-hidden shadow-lg rounded-2xl card-hover-effect border border-gray-100"
    >
      <div class="card-gradient-green p-4">
        <div class="flex items-center justify-between">
          <div class="bg-white/20 p-3 rounded-xl backdrop-blur-sm">
            <i class="fas fa-coins text-white text-lg"></i>
          </div>
          <div class="text-white/80 text-right">
            <div class="text-lg sm:text-xl font-bold text-white truncate">
              Rp <%= Math.floor(stats.totalZakat || 0).toLocaleString('id-ID')
              %>
            </div>
          </div>
        </div>
      </div>
      <div class="p-4">
        <h3 class="text-gray-700 font-semibold text-base">Zakat Terkumpul</h3>
        <p class="text-gray-500 text-sm mt-1">Total dana zakat</p>
        <div class="mt-3 flex items-center">
          <div
            class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs font-medium"
          >
            <i class="fas fa-check-circle mr-1"></i>Terkumpul
          </div>
        </div>
      </div>
    </div>

    <!-- Total Infak Card -->
    <div
      class="group bg-white overflow-hidden shadow-lg rounded-2xl card-hover-effect border border-gray-100"
    >
      <div class="card-gradient-purple p-4">
        <div class="flex items-center justify-between">
          <div class="bg-white/20 p-3 rounded-xl backdrop-blur-sm">
            <i class="fas fa-hand-holding-heart text-white text-lg"></i>
          </div>
          <div class="text-white/80 text-right">
            <div class="text-lg sm:text-xl font-bold text-white truncate">
              Rp <%= Math.floor(stats.totalInfak || 0).toLocaleString('id-ID')
              %>
            </div>
          </div>
        </div>
      </div>
      <div class="p-4">
        <h3 class="text-gray-700 font-semibold text-base">Total Infak</h3>
        <p class="text-gray-500 text-sm mt-1">Dana infak terkumpul</p>
        <div class="mt-3 flex items-center">
          <div
            class="bg-purple-100 text-purple-600 px-2 py-1 rounded-full text-xs font-medium"
          >
            <i class="fas fa-heart mr-1"></i>Sedekah
          </div>
        </div>
      </div>
    </div>

    <!-- Belum Bayar Card -->
    <div
      class="group bg-white overflow-hidden shadow-lg rounded-2xl card-hover-effect border border-gray-100"
    >
      <div class="card-gradient-red p-4">
        <div class="flex items-center justify-between">
          <div class="bg-white/20 p-3 rounded-xl backdrop-blur-sm">
            <i class="fas fa-exclamation-triangle text-white text-lg"></i>
          </div>
          <div class="text-white/80 text-right">
            <div class="text-2xl sm:text-3xl font-bold text-white">
              <%= stats.belumBayar || 0 %>
            </div>
          </div>
        </div>
      </div>
      <div class="p-4">
        <h3 class="text-gray-700 font-semibold text-base">Belum Bayar</h3>
        <p class="text-gray-500 text-sm mt-1">Memerlukan tindak lanjut</p>
        <div class="mt-3 flex items-center">
          <div
            class="bg-red-100 text-red-600 px-2 py-1 rounded-full text-xs font-medium"
          >
            <i class="fas fa-clock mr-1"></i>Pending
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Quick Actions -->
  <div
    class="bg-white shadow-xl rounded-2xl overflow-hidden border border-gray-100"
  >
    <div
      class="bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-5 border-b border-gray-200"
    >
      <div class="flex items-center">
        <div class="bg-blue-100 p-2 rounded-xl mr-3">
          <i class="fas fa-bolt text-blue-600 text-lg"></i>
        </div>
        <h2 class="text-xl font-bold text-gray-900">Quick Actions</h2>
        <span
          class="ml-3 bg-blue-100 text-blue-600 px-3 py-1 rounded-full text-xs font-medium"
          >Aksi Cepat</span
        >
      </div>
    </div>
    <div class="p-6">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
        <a
          href="/muzakki/create"
          class="group btn-gradient-primary text-white rounded-xl p-4 text-center"
        >
          <div class="flex flex-col items-center">
            <div
              class="bg-white/20 p-3 rounded-xl mb-3 group-hover:bg-white/30 transition-colors"
            >
              <i class="fas fa-plus text-xl"></i>
            </div>
            <span class="font-semibold text-sm sm:text-base"
              >Tambah Muzakki</span
            >
            <span class="text-blue-100 text-xs mt-1"
              >Daftarkan muzakki baru</span
            >
          </div>
        </a>

        <a
          href="/muzakki"
          class="group btn-gradient-indigo text-white rounded-xl p-4 text-center"
        >
          <div class="flex flex-col items-center">
            <div
              class="bg-white/20 p-3 rounded-xl mb-3 group-hover:bg-white/30 transition-colors"
            >
              <i class="fas fa-users text-xl"></i>
            </div>
            <span class="font-semibold text-sm sm:text-base">Data Muzakki</span>
            <span class="text-blue-100 text-xs mt-1">Lihat semua data</span>
          </div>
        </a>

        <a
          href="/laporan"
          class="group btn-gradient-green text-white rounded-xl p-4 text-center sm:col-span-2 lg:col-span-1"
        >
          <div class="flex flex-col items-center">
            <div
              class="bg-white/20 p-3 rounded-xl mb-3 group-hover:bg-white/30 transition-colors"
            >
              <i class="fas fa-chart-bar text-xl"></i>
            </div>
            <span class="font-semibold text-sm sm:text-base"
              >Lihat Laporan</span
            >
            <span class="text-green-100 text-xs mt-1"
              >Analisis data lengkap</span
            >
          </div>
        </a>
      </div>
    </div>
  </div>

  <!-- Enhanced Recent Activity Section -->
  <div class="grid grid-cols-1 xl:grid-cols-2 gap-6 lg:gap-8">
    <!-- Enhanced Muzakki Terbaru -->
    <div
      class="bg-white shadow-xl rounded-2xl overflow-hidden border border-gray-100"
    >
      <div
        class="bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-5 border-b border-gray-200"
      >
        <div class="flex items-center justify-between">
          <div class="flex items-center">
            <div class="bg-blue-100 p-2 rounded-xl mr-3">
              <i class="fas fa-user-plus text-blue-600 text-lg"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold text-gray-900">Muzakki Terbaru</h2>
              <p class="text-gray-600 text-sm">Data pendaftaran terkini</p>
            </div>
          </div>
          <span
            class="bg-blue-100 text-blue-600 px-3 py-1 rounded-full text-xs font-medium"
          >
            <i class="fas fa-clock mr-1"></i>Terbaru
          </span>
        </div>
      </div>

      <div class="p-6">
        <% if (recentMuzakki && recentMuzakki.length > 0) { %>
        <div class="space-y-4">
          <% recentMuzakki.forEach((muzakki, index) => { %>
          <div
            class="group bg-gradient-to-r from-gray-50 to-gray-100 hover:from-blue-50 hover:to-indigo-50 rounded-xl p-4 transition-all duration-300 border border-gray-200 hover:border-blue-200 hover:shadow-md"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center flex-1 min-w-0">
                <div
                  class="bg-blue-100 group-hover:bg-blue-200 w-10 h-10 rounded-xl flex items-center justify-center mr-3 transition-colors"
                >
                  <span class="text-blue-600 font-bold text-sm"
                    ><%= index + 1 %></span
                  >
                </div>
                <div class="flex-1 min-w-0">
                  <div
                    class="font-semibold text-gray-900 truncate text-sm sm:text-base"
                  >
                    <%= muzakki.nama %>
                  </div>
                  <div
                    class="text-gray-500 text-xs sm:text-sm flex items-center mt-1"
                  >
                    <i class="fas fa-home mr-1 text-gray-400"></i>
                    RT <%= muzakki.rt_nama %>
                    <span class="mx-2">â€¢</span>
                    <i class="fas fa-users mr-1 text-gray-400"></i>
                    <%= muzakki.jumlah_jiwa %> jiwa
                  </div>
                </div>
              </div>
              <div class="text-right ml-4">
                <div class="font-bold text-gray-900 text-sm sm:text-base">
                  Rp <%= new
                  Intl.NumberFormat('id-ID').format(muzakki.jumlah_zakat) %>
                </div>
                <div class="text-xs mt-1">
                  <% if (muzakki.status === 'lunas') { %>
                  <span
                    class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700"
                  >
                    <i class="fas fa-check-circle mr-1"></i>Lunas
                  </span>
                  <% } else { %>
                  <span
                    class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700"
                  >
                    <i class="fas fa-clock mr-1"></i>Belum Bayar
                  </span>
                  <% } %>
                </div>
              </div>
            </div>
          </div>
          <% }); %>
        </div>

        <div class="mt-6 text-center">
          <a
            href="/muzakki"
            class="inline-flex items-center px-4 py-2 btn-gradient-primary text-white rounded-xl font-medium text-sm"
          >
            <span>Lihat Semua Data</span>
            <i class="fas fa-arrow-right ml-2"></i>
          </a>
        </div>

        <% } else { %>
        <div class="text-center py-12">
          <div
            class="bg-gray-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"
          >
            <i class="fas fa-users text-gray-400 text-2xl"></i>
          </div>
          <h3 class="text-gray-900 font-semibold text-lg mb-2">
            Belum ada data muzakki
          </h3>
          <p class="text-gray-500 mb-6">
            Mulai dengan mendaftarkan muzakki pertama
          </p>
          <a
            href="/muzakki/create"
            class="inline-flex items-center px-6 py-3 btn-gradient-primary text-white rounded-xl font-semibold"
          >
            <i class="fas fa-plus mr-2"></i>Tambah Muzakki
          </a>
        </div>
        <% } %>
      </div>
    </div>

    <!-- Enhanced Summary RT -->
    <div
      class="bg-white shadow-xl rounded-2xl overflow-hidden border border-gray-100"
    >
      <div
        class="bg-gradient-to-r from-green-50 to-emerald-50 px-6 py-5 border-b border-gray-200"
      >
        <div class="flex items-center justify-between">
          <div class="flex items-center">
            <div class="bg-green-100 p-2 rounded-xl mr-3">
              <i class="fas fa-chart-pie text-green-600 text-lg"></i>
            </div>
            <div>
              <h2 class="text-xl font-bold text-gray-900">Summary per RT</h2>
              <p class="text-gray-600 text-sm">Statistik berdasarkan RT</p>
            </div>
          </div>
          <span
            class="bg-green-100 text-green-600 px-3 py-1 rounded-full text-xs font-medium"
          >
            <i class="fas fa-chart-bar mr-1"></i>Statistik
          </span>
        </div>
      </div>

      <div class="p-6">
        <% if (rtStats && rtStats.length > 0) { %>
        <div class="space-y-4">
          <% rtStats.forEach((rt, index) => { %>
          <div
            class="group bg-gradient-to-r from-gray-50 to-gray-100 hover:from-green-50 hover:to-emerald-50 rounded-xl p-4 transition-all duration-300 border border-gray-200 hover:border-green-200 hover:shadow-md"
          >
            <div class="flex items-center justify-between">
              <div class="flex items-center flex-1">
                <div
                  class="bg-green-100 group-hover:bg-green-200 w-10 h-10 rounded-xl flex items-center justify-center mr-3 transition-colors"
                >
                  <i class="fas fa-home text-green-600 text-sm"></i>
                </div>
                <div>
                  <div class="font-semibold text-gray-900 text-sm sm:text-base">
                    RT <%= rt.nomor_rt %>
                  </div>
                  <div
                    class="text-gray-500 text-xs sm:text-sm flex items-center mt-1"
                  >
                    <i class="fas fa-users mr-1 text-gray-400"></i>
                    <%= rt.total_muzakki %> muzakki
                  </div>
                </div>
              </div>
              <div class="text-right">
                <div class="font-bold text-gray-900 text-sm sm:text-base">
                  Rp <%= Math.floor(rt.total_zakat).toLocaleString('id-ID') %>
                </div>
                <div class="text-xs mt-1 space-x-1">
                  <span
                    class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-700"
                  >
                    <%= rt.lunas %> lunas
                  </span>
                  <% if (rt.belum_bayar > 0) { %>
                  <span
                    class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-700"
                  >
                    <%= rt.belum_bayar %> belum
                  </span>
                  <% } %>
                </div>
              </div>
            </div>
          </div>
          <% }); %>
        </div>

        <% } else { %>
        <div class="text-center py-12">
          <div
            class="bg-gray-100 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4"
          >
            <i class="fas fa-chart-pie text-gray-400 text-2xl"></i>
          </div>
          <h3 class="text-gray-900 font-semibold text-lg mb-2">
            Belum ada data statistik RT
          </h3>
          <p class="text-gray-500">
            Data akan muncul setelah ada muzakki terdaftar
          </p>
        </div>
        <% } %>
      </div>
    </div>
  </div>
</div>

<!-- JavaScript for Enhanced Features -->
<script>
  // Set current date
  document.addEventListener("DOMContentLoaded", function () {
    const currentDate = document.getElementById("current-date");
    if (currentDate) {
      const now = new Date();
      const options = {
        weekday: "long",
        year: "numeric",
        month: "long",
        day: "numeric",
      };
      currentDate.textContent = now.toLocaleDateString("id-ID", options);
    }

    // Add subtle animations to cards
    const cards = document.querySelectorAll(".group");
    cards.forEach((card, index) => {
      card.style.animationDelay = `${index * 0.1}s`;
      card.classList.add("animate-fade-in-up");
    });
  });
</script>

<style>
  /* Custom Primary Colors */
  :root {
    --primary-50: #eff6ff;
    --primary-100: #dbeafe;
    --primary-200: #bfdbfe;
    --primary-300: #93c5fd;
    --primary-400: #60a5fa;
    --primary-500: #3b82f6;
    --primary-600: #2563eb;
    --primary-700: #1d4ed8;
    --primary-800: #1e40af;
    --primary-900: #1e3a8a;
  }

  /* Enhanced Dashboard Styles */
  .dashboard-gradient-header {
    background: linear-gradient(135deg, #1e40af 0%, #1d4ed8 50%, #2563eb 100%);
    position: relative;
    overflow: hidden;
  }

  .dashboard-gradient-header::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      45deg,
      rgba(255, 255, 255, 0.1) 0%,
      transparent 50%,
      rgba(255, 255, 255, 0.05) 100%
    );
    pointer-events: none;
  }

  .card-gradient-blue {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
  }

  .card-gradient-green {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  }

  .card-gradient-purple {
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
  }

  .card-gradient-red {
    background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
  }

  .btn-gradient-primary {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    transition: all 0.3s ease;
  }

  .btn-gradient-primary:hover {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
  }

  .btn-gradient-indigo {
    background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
    transition: all 0.3s ease;
  }

  .btn-gradient-indigo:hover {
    background: linear-gradient(135deg, #4f46e5 0%, #4338ca 100%);
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(99, 102, 241, 0.4);
  }

  .btn-gradient-green {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    transition: all 0.3s ease;
  }

  .btn-gradient-green:hover {
    background: linear-gradient(135deg, #059669 0%, #047857 100%);
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(16, 185, 129, 0.4);
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0px);
    }
    50% {
      transform: translateY(-10px);
    }
  }

  .animate-fade-in-up {
    animation: fadeInUp 0.6s ease-out forwards;
  }

  .animate-float {
    animation: float 3s ease-in-out infinite;
  }

  /* Custom scrollbar for better aesthetics */
  ::-webkit-scrollbar {
    width: 6px;
  }

  ::-webkit-scrollbar-track {
    background: #f1f5f9;
  }

  ::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 3px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
  }

  /* Enhanced hover effects */
  .card-hover-effect {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .card-hover-effect:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  }

  /* Glassmorphism effect */
  .glass-effect {
    backdrop-filter: blur(16px);
    background: rgba(255, 255, 255, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
</style>

<%- include('layouts/footer') %>
