<%- include('../layouts/header', { title: 'Data Infak - Zakat Fitrah App',
bodyClass: 'bg-gray-50 min-h-screen', currentPage: 'infak' }) %>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-3xl font-bold text-gray-900">
        <i class="fas fa-hand-holding-heart mr-2 text-primary-600"></i>Data
        Infak
      </h1>
      <p class="text-gray-600 mt-1">
        Daftar infak yang terkumpul dari kembalian zakat
      </p>
    </div>
  </div>

  <!-- Statistics Card -->
  <div class="card mb-6">
    <div class="text-center">
      <div class="text-4xl font-bold text-primary-600 mb-2">
        Rp <%= Math.floor(infak.reduce((total, item) => total + item.jumlah,
        0)).toLocaleString('id-ID') %>
      </div>
      <div class="text-gray-600">Total Infak Terkumpul</div>
      <div class="text-sm text-gray-500 mt-1">
        Dari <%= infak.length %> transaksi infak
      </div>
    </div>
  </div>

  <!-- Data Table -->
  <div class="card">
    <div class="table-responsive">
      <% if (infak.length === 0) { %>
      <div class="text-center py-12">
        <i class="fas fa-hand-holding-heart text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-medium text-gray-900 mb-2">Belum ada infak</h3>
        <p class="text-gray-600 mb-6">
          Infak akan muncul otomatis ketika ada kembalian zakat yang
          disedekahkan
        </p>
        <a href="/muzakki" class="btn-primary">
          <i class="fas fa-users mr-2"></i>Lihat Data Muzakki
        </a>
      </div>
      <% } else { %>
      <table class="table">
        <thead>
          <tr>
            <th>Tanggal</th>
            <th>Dari Muzakki</th>
            <th>RT</th>
            <th>Jumlah Infak</th>
            <th>Keterangan</th>
          </tr>
        </thead>
        <tbody>
          <% infak.forEach(function(item) { %>
          <tr>
            <td>
              <div class="font-medium text-gray-900">
                <%= new Date(item.created_at).toLocaleDateString('id-ID', {
                weekday: 'short', year: 'numeric', month: 'short', day:
                'numeric' }) %>
              </div>
              <div class="text-xs text-gray-500">
                <%= new Date(item.created_at).toLocaleTimeString('id-ID', {
                hour: '2-digit', minute: '2-digit' }) %>
              </div>
            </td>
            <td>
              <div class="font-medium text-gray-900">
                <%= item.muzakki_name || '-' %>
              </div>
              <div class="text-xs text-gray-500">
                ID: <%= item.muzakki_id %>
              </div>
            </td>
            <td>
              <% if (item.nomor_rt) { %>
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"
              >
                <%= item.nomor_rt %>
              </span>
              <% } else { %>
              <span class="text-gray-400">-</span>
              <% } %>
            </td>
            <td>
              <div class="font-bold text-primary-600 text-lg">
                Rp <%= Math.floor(item.jumlah).toLocaleString('id-ID') %>
              </div>
            </td>
            <td>
              <div class="text-sm text-gray-600">
                <%= item.keterangan || '-' %>
              </div>
            </td>
          </tr>
          <% }); %>
        </tbody>
        <tfoot>
          <tr class="bg-gray-50">
            <td colspan="3" class="font-bold text-gray-900">Total Infak</td>
            <td class="font-bold text-primary-600 text-lg">
              Rp <%= Math.floor(infak.reduce((total, item) => total +
              item.jumlah, 0)).toLocaleString('id-ID') %>
            </td>
            <td></td>
          </tr>
        </tfoot>
      </table>
      <% } %>
    </div>
  </div>

  <!-- Information Card -->
  <div class="mt-6 card">
    <h3 class="text-lg font-semibold text-gray-900 mb-4">
      <i class="fas fa-info-circle mr-2 text-blue-600"></i>Informasi Infak
    </h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-gray-600">
      <div>
        <h4 class="font-medium text-gray-900 mb-2">Sumber Infak</h4>
        <ul class="space-y-1">
          <li>• Kembalian dari pembayaran zakat fitrah</li>
          <li>• Otomatis tercatat saat kembalian disedekahkan</li>
          <li>• Dapat digunakan untuk keperluan sosial</li>
        </ul>
      </div>
      <div>
        <h4 class="font-medium text-gray-900 mb-2">Pemanfaatan</h4>
        <ul class="space-y-1">
          <li>• Bantuan untuk mustahik</li>
          <li>• Kegiatan sosial masyarakat</li>
          <li>• Operasional kegiatan zakat</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<%- include('../layouts/footer') %>
