<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="mb-6">
    <h1 class="text-3xl font-bold text-gray-900">
      <i class="fas fa-chart-bar mr-2 text-primary-600"></i>Laporan Zakat
    </h1>
    <p class="text-gray-600 mt-1">
      Laporan pengumpulan dan distribusi zakat fitrah per RT
    </p>
  </div>

  <!-- Summary Cards -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
    <div class="card text-center">
      <div class="text-3xl font-bold text-primary-600">
        <%= laporanRT.reduce((total, rt) => total + (rt.total_muzakki || 0), 0)
        %>
      </div>
      <div class="text-sm text-gray-600">Total Muzakki</div>
    </div>
    <div class="card text-center">
      <div class="text-3xl font-bold text-green-600">
        <%= laporanRT.reduce((total, rt) => total + (rt.total_beras_kg || 0),
        0).toFixed(1) %> kg
      </div>
      <div class="text-sm text-gray-600">Total Beras</div>
    </div>
    <div class="card text-center">
      <div class="text-3xl font-bold text-blue-600">
        Rp <%= laporanRT.reduce((total, rt) => total + (rt.total_terkumpul ||
        0), 0).toLocaleString('id-ID') %>
      </div>
      <div class="text-sm text-gray-600">Total Terkumpul</div>
    </div>
    <div class="card text-center">
      <div class="text-3xl font-bold text-yellow-600">
        Rp <%= totalInfak.toLocaleString('id-ID') %>
      </div>
      <div class="text-sm text-gray-600">Total Infak</div>
    </div>
  </div>

  <!-- Laporan Per RT -->
  <div class="card">
    <div class="mb-4">
      <h2 class="text-xl font-semibold text-gray-900">
        <i class="fas fa-map-marker-alt mr-2 text-gray-600"></i>Laporan Per RT
      </h2>
    </div>

    <div class="table-responsive">
      <% if (laporanRT.length === 0) { %>
      <div class="text-center py-12">
        <i class="fas fa-chart-bar text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-medium text-gray-900 mb-2">
          Belum ada data laporan
        </h3>
        <p class="text-gray-600 mb-6">
          Laporan akan muncul setelah ada data muzakki
        </p>
        <a href="/muzakki/create" class="btn-primary">
          <i class="fas fa-plus mr-2"></i>Tambah Muzakki
        </a>
      </div>
      <% } else { %>
      <table class="table">
        <thead>
          <tr>
            <th>RT</th>
            <th>Ketua RT</th>
            <th>Jumlah Muzakki</th>
            <th>Zakat Beras</th>
            <th>Kewajiban Uang</th>
            <th>Total Terkumpul</th>
            <th>Kembalian</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <% laporanRT.forEach(function(rt) { %>
          <tr>
            <td>
              <div class="font-medium text-primary-600"><%= rt.nomor_rt %></div>
            </td>
            <td>
              <div class="font-medium text-gray-900"><%= rt.ketua_rt %></div>
            </td>
            <td class="text-center">
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"
              >
                <%= rt.total_muzakki || 0 %> orang
              </span>
            </td>
            <td>
              <% if (rt.total_beras_kg > 0) { %>
              <div class="font-medium text-green-600">
                <%= rt.total_beras_kg.toFixed(1) %> kg
              </div>
              <% } else { %>
              <span class="text-gray-400">-</span>
              <% } %>
            </td>
            <td>
              <% if (rt.total_uang_kewajiban > 0) { %>
              <div class="font-medium text-blue-600">
                Rp <%= rt.total_uang_kewajiban.toLocaleString('id-ID') %>
              </div>
              <% } else { %>
              <span class="text-gray-400">-</span>
              <% } %>
            </td>
            <td>
              <div class="font-bold text-primary-600">
                Rp <%= (rt.total_terkumpul || 0).toLocaleString('id-ID') %>
              </div>
            </td>
            <td>
              <% if (rt.total_kembalian > 0) { %>
              <div class="font-medium text-yellow-600">
                Rp <%= rt.total_kembalian.toLocaleString('id-ID') %>
              </div>
              <% } else { %>
              <span class="text-gray-400">-</span>
              <% } %>
            </td>
            <td>
              <% if (rt.total_muzakki > 0) { %>
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"
              >
                <i class="fas fa-check mr-1"></i>Aktif
              </span>
              <% } else { %>
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"
              >
                <i class="fas fa-minus mr-1"></i>Belum Ada
              </span>
              <% } %>
            </td>
          </tr>
          <% }); %>
        </tbody>
        <tfoot>
          <tr class="bg-gray-50">
            <td colspan="2" class="font-bold text-gray-900">TOTAL</td>
            <td class="text-center font-bold text-gray-900">
              <%= laporanRT.reduce((total, rt) => total + (rt.total_muzakki ||
              0), 0) %> orang
            </td>
            <td class="font-bold text-green-600">
              <%= laporanRT.reduce((total, rt) => total + (rt.total_beras_kg ||
              0), 0).toFixed(1) %> kg
            </td>
            <td class="font-bold text-blue-600">
              Rp <%= laporanRT.reduce((total, rt) => total +
              (rt.total_uang_kewajiban || 0), 0).toLocaleString('id-ID') %>
            </td>
            <td class="font-bold text-primary-600">
              Rp <%= laporanRT.reduce((total, rt) => total + (rt.total_terkumpul
              || 0), 0).toLocaleString('id-ID') %>
            </td>
            <td class="font-bold text-yellow-600">
              Rp <%= laporanRT.reduce((total, rt) => total + (rt.total_kembalian
              || 0), 0).toLocaleString('id-ID') %>
            </td>
            <td></td>
          </tr>
        </tfoot>
      </table>
      <% } %>
    </div>
  </div>

  <!-- Summary Information -->
  <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
    <div class="card">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">
        <i class="fas fa-info-circle mr-2 text-blue-600"></i>Ringkasan Zakat
      </h3>
      <div class="space-y-3 text-sm">
        <div class="flex justify-between">
          <span class="text-gray-600">Total RT:</span>
          <span class="font-medium"><%= laporanRT.length %> RT</span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">RT dengan Muzakki:</span>
          <span class="font-medium">
            <%= laporanRT.filter(rt => rt.total_muzakki > 0).length %> RT
          </span>
        </div>
        <div class="flex justify-between">
          <span class="text-gray-600">Rata-rata per RT:</span>
          <span class="font-medium">
            <%= laporanRT.length > 0 ? Math.round(laporanRT.reduce((total, rt)
            => total + (rt.total_muzakki || 0), 0) / laporanRT.length) : 0 %>
            muzakki
          </span>
        </div>
        <div class="flex justify-between border-t pt-3">
          <span class="text-gray-600">Status Pengumpulan:</span>
          <span class="font-medium text-green-600">
            <i class="fas fa-chart-line mr-1"></i>
            <%= laporanRT.filter(rt => rt.total_muzakki > 0).length > 0 ?
            'Aktif' : 'Belum Dimulai' %>
          </span>
        </div>
      </div>
    </div>

    <div class="card">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">
        <i class="fas fa-calculator mr-2 text-green-600"></i>Perhitungan Zakat
      </h3>
      <div class="space-y-3 text-sm">
        <div class="p-3 bg-green-50 rounded-lg">
          <div class="font-medium text-green-800 mb-1">Zakat Beras</div>
          <div class="text-green-600">2.5 kg per jiwa</div>
        </div>
        <div class="p-3 bg-blue-50 rounded-lg">
          <div class="font-medium text-blue-800 mb-1">Zakat Uang</div>
          <div class="text-blue-600">Rp 45.000 per jiwa</div>
        </div>
        <div class="p-3 bg-yellow-50 rounded-lg">
          <div class="font-medium text-yellow-800 mb-1">Infak Terkumpul</div>
          <div class="text-yellow-600">
            Rp <%= totalInfak.toLocaleString('id-ID') %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
