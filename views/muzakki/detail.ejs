<%- include('../layouts/header', { title: 'Detail Muzakki - Zakat Fitrah App',
bodyClass: 'bg-gray-50 min-h-screen', currentPage: 'muzakki' }) %>

<div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="mb-6">
    <div class="flex items-center justify-between mb-4">
      <div class="flex items-center">
        <a href="/muzakki" class="text-primary-600 hover:text-primary-800 mr-4">
          <i class="fas fa-arrow-left"></i>
        </a>
        <h1 class="text-3xl font-bold text-gray-900">
          <i class="fas fa-eye mr-2 text-primary-600"></i>Detail Muzakki
        </h1>
      </div>
      <div class="flex space-x-2">
        <a href="/muzakki/<%= muzakki.id %>/edit" class="btn-secondary">
          <i class="fas fa-edit mr-2"></i>Edit
        </a>
        <a href="/muzakki" class="btn-outline">
          <i class="fas fa-list mr-2"></i>Kembali ke List
        </a>
      </div>
    </div>
    <p class="text-gray-600">
      Detail lengkap data muzakki dan informasi zakat fitrah
    </p>
  </div>

  <!-- Detail Card -->
  <div class="card">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Informasi Dasar -->
      <div>
        <h3 class="text-lg font-semibold text-gray-900 mb-4">
          <i class="fas fa-user mr-2 text-primary-600"></i>Informasi Dasar
        </h3>
        <div class="space-y-3">
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Nama-nama Muzakki</label
            >
            <div class="mt-1 space-y-2">
              <% if (muzakkiDetails.length > 0) { %> <%
              muzakkiDetails.forEach(function(detail, index) { %>
              <div class="p-3 bg-gray-50 rounded-lg border">
                <div class="font-medium text-gray-900">
                  <%= index + 1 %>. <%= detail.nama_muzakki %>
                </div>
                <div class="text-sm text-gray-600 mt-1">
                  <% if (detail.bin_binti) { %>
                  <span
                    class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium <%= detail.bin_binti === 'bin' ? 'bg-blue-100 text-blue-800' : 'bg-pink-100 text-pink-800' %>"
                  >
                    <i
                      class="fas <%= detail.bin_binti === 'bin' ? 'fa-mars' : 'fa-venus' %> mr-1"
                    ></i>
                    <%= detail.bin_binti === 'bin' ? 'Bin (Laki-laki)' : 'Binti
                    (Perempuan)' %>
                  </span>
                  <% } %> <% if (detail.nama_orang_tua) { %>
                  <span class="ml-2">
                    <i class="fas fa-users text-gray-400 mr-1"></i>
                    <%= detail.nama_orang_tua %>
                  </span>
                  <% } %>
                </div>
              </div>
              <% }); %> <% } else { %>
              <p class="text-sm text-gray-500">Tidak ada detail muzakki</p>
              <% } %>
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">RT</label>
            <p class="mt-1 text-sm text-gray-900">
              <%= muzakki.nomor_rt || '-' %> - <%= muzakki.ketua_rt || '-' %>
            </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Jumlah Jiwa</label
            >
            <p class="mt-1 text-sm text-gray-900">
              <%= muzakki.jumlah_jiwa %> jiwa
            </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Jenis Zakat</label
            >
            <p class="mt-1">
              <% if (muzakki.jenis_zakat === 'beras') { %>
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"
              >
                <i class="fas fa-seedling mr-1"></i>Beras
              </span>
              <% } else { %>
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
              >
                <i class="fas fa-coins mr-1"></i>Uang
              </span>
              <% } %>
            </p>
          </div>
        </div>
      </div>

      <!-- Informasi Zakat -->
      <div>
        <h3 class="text-lg font-semibold text-gray-900 mb-4">
          <i class="fas fa-calculator mr-2 text-primary-600"></i>Informasi Zakat
        </h3>
        <div class="space-y-3">
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Kewajiban Zakat</label
            >
            <p class="mt-1 text-sm font-medium text-gray-900">
              <% if (muzakki.jenis_zakat === 'beras') { %> <%=
              muzakki.jumlah_beras_kg %> kg beras <% } else { %> Rp <%=
              Math.floor(muzakki.jumlah_uang).toLocaleString('id-ID') %> <% } %>
            </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Jumlah Bayar</label
            >
            <p class="mt-1 text-sm font-medium text-green-600">
              Rp <%= Math.floor(muzakki.jumlah_bayar).toLocaleString('id-ID') %>
            </p>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700"
              >Kembalian</label
            >
            <p
              class="mt-1 text-sm font-medium <%= muzakki.kembalian > 0 ? 'text-yellow-600' : 'text-gray-600' %>"
            >
              <% if (muzakki.kembalian > 0) { %> Rp <%=
              Math.floor(muzakki.kembalian).toLocaleString('id-ID') %> <% } else
              { %> - <% } %>
            </p>
          </div>
          <% if (muzakki.kembalian > 0) { %>
          <div>
            <form
              method="POST"
              action="/muzakki/<%= muzakki.id %>/sedekahkan-kembalian"
              class="inline"
            >
              <button
                type="submit"
                class="btn-success text-sm"
                onclick="return confirm('Sedekahkan kembalian sebagai infak?')"
              >
                <i class="fas fa-hand-holding-heart mr-2"></i>Sedekahkan
                Kembalian
              </button>
            </form>
          </div>
          <% } %>
        </div>
      </div>
    </div>

    <!-- Catatan -->
    <% if (muzakki.catatan) { %>
    <div class="mt-6 pt-6 border-t border-gray-200">
      <h3 class="text-lg font-semibold text-gray-900 mb-2">
        <i class="fas fa-sticky-note mr-2 text-primary-600"></i>Catatan
      </h3>
      <p class="text-sm text-gray-700"><%= muzakki.catatan %></p>
    </div>
    <% } %>

    <!-- Informasi Sistem -->
    <div class="mt-6 pt-6 border-t border-gray-200">
      <h3 class="text-lg font-semibold text-gray-900 mb-4">
        <i class="fas fa-info-circle mr-2 text-primary-600"></i>Informasi Sistem
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium text-gray-700"
            >Pencatat</label
          >
          <p class="mt-1 text-sm text-gray-900">
            <%= muzakki.pencatat_name || '-' %>
          </p>
        </div>
        <div>
          <label class="block text-sm font-medium text-gray-700"
            >Tanggal Dibuat</label
          >
          <p class="mt-1 text-sm text-gray-900">
            <%= new Date(muzakki.created_at).toLocaleDateString('id-ID', {
            weekday: 'long', year: 'numeric', month: 'long', day: 'numeric',
            hour: '2-digit', minute: '2-digit' }) %>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('../layouts/footer') %>
