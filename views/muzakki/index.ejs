<%- include('../layouts/header', { title: 'Data Muzakki - Zakat Fitrah App',
bodyClass: 'bg-gray-50 min-h-screen', currentPage: 'muzakki' }) %>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
  <!-- Header -->
  <div class="flex justify-between items-center mb-6">
    <div>
      <h1 class="text-3xl font-bold text-gray-900">
        <i class="fas fa-users mr-2 text-primary-600"></i>Data Muzakki
      </h1>
      <p class="text-gray-600 mt-1">Kelola data muzakki dan zakat fitrah</p>
    </div>
    <a href="/muzakki/create" class="btn-primary">
      <i class="fas fa-plus mr-2"></i>Tambah Muzakki
    </a>
  </div>

  <!-- Statistics Cards -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
    <div class="card text-center">
      <div class="text-3xl font-bold text-primary-600">
        <%= stats.total_muzakki_records || 0 %>
      </div>
      <div class="text-sm text-gray-600">Total Data Muzakki</div>
    </div>
    <div class="card text-center">
      <div class="text-3xl font-bold text-purple-600">
        <%= stats.total_nama_muzakki_all || 0 %>
      </div>
      <div class="text-sm text-gray-600">Total Nama Muzakki</div>
    </div>
    <div class="card text-center">
      <div class="text-3xl font-bold text-green-600">
        <%= Math.floor(stats.total_beras_all || 0) %> kg
      </div>
      <div class="text-sm text-gray-600">Total Zakat Beras</div>
    </div>
    <div class="card text-center">
      <div class="text-3xl font-bold text-blue-600">
        Rp <%= Math.floor(stats.total_uang_all || 0).toLocaleString('id-ID') %>
      </div>
      <div class="text-sm text-gray-600">Total Zakat Uang</div>
    </div>
  </div>

  <!-- Data Table -->
  <div class="card">
    <div class="table-responsive">
      <% if (rtData.length === 0) { %>
      <div class="text-center py-12">
        <i class="fas fa-users text-6xl text-gray-300 mb-4"></i>
        <h3 class="text-xl font-medium text-gray-900 mb-2">
          Belum ada data muzakki
        </h3>
        <p class="text-gray-600 mb-6">
          Mulai dengan menambahkan data muzakki pertama
        </p>
        <a href="/muzakki/create" class="btn-primary">
          <i class="fas fa-plus mr-2"></i>Tambah Muzakki
        </a>
      </div>
      <% } else { %>
      <table class="table">
        <thead>
          <tr>
            <th>RT</th>
            <th>Ketua RT</th>
            <th>Total Data Muzakki</th>
            <th>Total Nama Muzakki</th>
            <th>Total Jiwa</th>
            <th>Total Beras</th>
            <th>Total Uang</th>
            <th>Total Kembalian</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody>
          <% rtData.forEach(function(rt) { %>
          <tr>
            <td>
              <div class="font-medium text-lg text-primary-600">
                RT <%= rt.nomor_rt %>
              </div>
            </td>
            <td>
              <div class="font-medium text-gray-900">
                <%= rt.ketua_rt || '-' %>
              </div>
            </td>
            <td class="text-center">
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"
              >
                <%= rt.total_muzakki || 0 %> data
              </span>
            </td>
            <td class="text-center">
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800"
              >
                <%= rt.total_nama_muzakki || 0 %> orang
              </span>
            </td>
            <td class="text-center">
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800"
              >
                <%= rt.total_jiwa || 0 %> jiwa
              </span>
            </td>
            <td class="text-center">
              <% if (rt.total_beras > 0) { %>
              <div class="font-medium text-green-600">
                <%= Math.floor(rt.total_beras).toLocaleString('id-ID') %> kg
              </div>
              <% } else { %>
              <div class="text-gray-400">-</div>
              <% } %>
            </td>
            <td class="text-center">
              <% if (rt.total_uang > 0) { %>
              <div class="font-medium text-blue-600">
                Rp <%= Math.floor(rt.total_uang).toLocaleString('id-ID') %>
              </div>
              <% } else { %>
              <div class="text-gray-400">-</div>
              <% } %>
            </td>
            <td class="text-center">
              <% if (rt.total_kembalian > 0) { %>
              <div class="font-medium text-yellow-600">
                Rp <%= Math.floor(rt.total_kembalian).toLocaleString('id-ID') %>
              </div>
              <% } else { %>
              <div class="text-gray-400">-</div>
              <% } %>
            </td>
            <td>
              <div class="flex gap-2">
                <a
                  href="/muzakki/rt/<%= rt.rt_id %>"
                  class="btn-sm bg-green-600 text-white px-3 py-1 rounded text-xs hover:bg-green-700"
                  title="Detail Muzakki RT <%= rt.nomor_rt %>"
                >
                  <i class="fas fa-eye mr-1"></i>Detail
                </a>
              </div>
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>
      <% } %>
    </div>
  </div>
</div>

<%- include('../layouts/footer') %>
