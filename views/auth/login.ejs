<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= title %></title>
    <link href="/css/output.css" rel="stylesheet" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      /* Custom styles untuk meningkatkan tampilan */
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        transition: all 0.3s ease;
      }
      
      .login-container {
        animation: fadeIn 0.8s ease-out;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.15);
        border-radius: 16px;
        overflow: hidden;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(10px);
      }
      
      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
      }
      
      .mosque-icon {
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
      }
      
      .mosque-icon:hover {
        transform: scale(1.05);
        box-shadow: 0 8px 20px rgba(79, 70, 229, 0.4);
      }
      
      .form-input {
        transition: all 0.3s ease;
        border: 1px solid #d1d5db;
      }
      
      .form-input:focus {
        border-color: #4f46e5;
        box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        transform: translateY(-2px);
      }
      
      .btn-primary {
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
      }
      
      .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(79, 70, 229, 0.3);
      }
      
      .btn-primary:active {
        transform: translateY(0);
      }
      
      .btn-primary::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 5px;
        height: 5px;
        background: rgba(255, 255, 255, 0.5);
        opacity: 0;
        border-radius: 100%;
        transform: scale(1, 1) translate(-50%);
        transform-origin: 50% 50%;
      }
      
      .btn-primary:focus:not(:active)::after {
        animation: ripple 1s ease-out;
      }
      
      @keyframes ripple {
        0% {
          transform: scale(0, 0);
          opacity: 0.5;
        }
        20% {
          transform: scale(15, 15);
          opacity: 0.3;
        }
        100% {
          transform: scale(25, 25);
          opacity: 0;
        }
      }
      
      .alert-success, .alert-error {
        animation: slideIn 0.5s ease-out;
        border-radius: 8px;
        padding: 12px 16px;
        margin-bottom: 16px;
        display: flex;
        align-items: center;
        transition: all 0.3s ease;
      }
      
      .alert-success {
        background-color: #d1fae5;
        color: #065f46;
        border-left: 4px solid #10b981;
      }
      
      .alert-error {
        background-color: #fee2e2;
        color: #991b1b;
        border-left: 4px solid #ef4444;
      }
      
      @keyframes slideIn {
        from { transform: translateX(-20px); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      
      .footer-text {
        font-size: 0.75rem;
        line-height: 1.4;
      }
      
      /* Responsive improvements */
      @media (max-width: 640px) {
        .login-container {
          margin: 0 16px;
          padding: 24px 20px;
        }
        
        h2 {
          font-size: 1.75rem;
        }
        
        .form-input {
          padding: 12px 14px;
        }
      }
      
      /* Background animation */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);
        z-index: -1;
      }
      
      /* Floating elements untuk background yang lebih menarik */
      .floating-element {
        position: fixed;
        border-radius: 50%;
        background: rgba(79, 70, 229, 0.05);
        z-index: -1;
      }
      
      .floating-element:nth-child(1) {
        width: 200px;
        height: 200px;
        top: 10%;
        left: 5%;
        animation: float 15s infinite ease-in-out;
      }
      
      .floating-element:nth-child(2) {
        width: 150px;
        height: 150px;
        bottom: 15%;
        right: 10%;
        animation: float 12s infinite ease-in-out reverse;
      }
      
      @keyframes float {
        0%, 100% { transform: translateY(0) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(5deg); }
      }
    </style>
  </head>
  <body class="min-h-screen flex items-center justify-center px-4 py-8">
    <!-- Floating background elements -->
    <div class="floating-element"></div>
    <div class="floating-element"></div>
    
    <div class="max-w-md w-full login-container p-8">
      <!-- Header -->
      <div class="text-center mb-8">
        <div
          class="mx-auto h-20 w-20 bg-gradient-to-br from-primary-500 to-primary-700 rounded-full flex items-center justify-center mosque-icon"
        >
          <i class="fas fa-mosque text-white text-3xl"></i>
        </div>
        <h2 class="mt-6 text-3xl font-bold text-gray-900">Zakat Fitrah</h2>
        <p class="mt-2 text-sm text-gray-600">
          Silakan login untuk mengakses sistem
        </p>
      </div>

      <!-- Flash Messages -->
      <% if (success_msg && success_msg.length > 0) { %>
      <div class="alert-success">
        <i class="fas fa-check-circle mr-2"></i><%= success_msg %>
      </div>
      <% } %> 
      <% if (error_msg && error_msg.length > 0) { %>
      <div class="alert-error">
        <i class="fas fa-exclamation-circle mr-2"></i><%= error_msg %>
      </div>
      <% } %> 
      <% if (error && error.length > 0) { %>
      <div class="alert-error">
        <i class="fas fa-exclamation-circle mr-2"></i><%= error %>
      </div>
      <% } %>

      <!-- Login Form -->
      <form class="space-y-6" action="/auth/login" method="POST">
        <div class="space-y-5">
          <div>
            <label
              for="nomor_wa"
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              <i class="fab fa-whatsapp mr-1 text-green-600"></i>Nomor WhatsApp
            </label>
            <input
              id="nomor_wa"
              name="nomor_wa"
              type="text"
              required
              class="w-full form-input px-4 py-3 rounded-lg border transition-all duration-300 focus:outline-none"
              placeholder="Contoh: 08123456789"
              pattern="[0-9]{10,15}"
              title="Masukkan nomor WhatsApp yang valid (10-15 digit)"
            />
          </div>

          <div>
            <label
              for="password"
              class="block text-sm font-medium text-gray-700 mb-2"
            >
              <i class="fas fa-lock mr-1 text-gray-600"></i>Password
            </label>
            <input
              id="password"
              name="password"
              type="password"
              required
              class="w-full form-input px-4 py-3 rounded-lg border transition-all duration-300 focus:outline-none"
              placeholder="Masukkan password Anda"
            />
          </div>
        </div>

        <div class="pt-2">
          <button type="submit" class="w-full btn-primary bg-primary-600 hover:bg-primary-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-300">
            <i class="fas fa-sign-in-alt mr-2"></i>Login
          </button>
        </div>

        <!-- Development Only: Register Link -->
        <% if (process.env.NODE_ENV === 'development') { %>
        <div class="text-center pt-4">
          <p class="text-sm text-gray-600">
            Belum punya akun?
            <a
              href="/auth/register"
              class="font-medium text-primary-600 hover:text-primary-500 transition-colors duration-300"
            >
              Daftar di sini
            </a>
          </p>
        </div>
        <% } %>
      </form>

      <!-- Footer -->
      <div class="text-center mt-8 pt-6 border-t border-gray-100">
        <p class="footer-text text-gray-500">
          © <%= new Date().getFullYear() %> Aplikasi Zakat Fitrah<br />
          Dibuat dengan <span class="text-red-500">❤️</span> untuk kemudahan pengelolaan zakat
        </p>
      </div>
    </div>

    <script>
      // Auto hide flash messages after 5 seconds
      setTimeout(function () {
        const alerts = document.querySelectorAll(
          ".alert-success, .alert-error"
        );
        alerts.forEach(function (alert) {
          alert.style.opacity = "0";
          setTimeout(function () {
            alert.remove();
          }, 300);
        });
      }, 5000);

      // Format phone number input
      document
        .getElementById("nomor_wa")
        .addEventListener("input", function (e) {
          let value = e.target.value.replace(/[^\d]/g, "");

          // Add leading zero if not present and not starting with +62
          if (
            value.length > 0 &&
            !value.startsWith("0") &&
            !value.startsWith("62")
          ) {
            value = "0" + value;
          }

          e.target.value = value;
        });
      
      // Tambahkan efek saat halaman dimuat
      document.addEventListener('DOMContentLoaded', function() {
        // Animasi untuk elemen form
        const formInputs = document.querySelectorAll('.form-input');
        formInputs.forEach((input, index) => {
          input.style.animationDelay = `${index * 0.1}s`;
        });
      });
    </script>
  </body>
</html>